// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
// <- VERTEX ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#version 330

in vec2 position;


void main() {
    gl_Position = vec4(position,0.0, 1.0); 
}

// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
// <- FRAGMENT ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#version 330

uniform sampler2D input_texture;

uniform uvec2 frame_size;

out vec4 frag_color;

const int samples = 16;
vec2 sample_sphere[samples] = vec2[](
    vec2( 0.5381, 0.1856), vec2( 0.1379, 0.2486),
    vec2( 0.3371, 0.5679), vec2(-0.6999,-0.0451),
    vec2( 0.0689,-0.1598), vec2( 0.0560, 0.0069),
    vec2(-0.0146, 0.1402), vec2( 0.0100,-0.1924),
    vec2(-0.3577,-0.5301), vec2(-0.3169, 0.1063),
    vec2( 0.0103,-0.5869), vec2(-0.0897,-0.4940),
    vec2( 0.7119,-0.0154), vec2(-0.0533, 0.0596),
    vec2( 0.0352,-0.0631), vec2(-0.4776, 0.2847)
);

void main(void)
{

    for(int i=0; i < samples; i++)
    {
        vec2 coords = gl_FragCoord.xy - 0.5 + sample_sphere[i] *2;
        frag_color += texelFetch(input_texture,  ivec2(coords), 0 );
    }

    frag_color = frag_color/samples;
}
